{
  "hash": "77fa5c6a539350687ce4c3108280d7a0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pivot\"\n\ndate-modified: 'today'\ndate-format: long\n\nformat: \n  html:\n    footer: \"CC BY 4.0 John R Little\"\n\nlicense: CC BY-NC    \nbibliography: references.bib\n---\n\n\nOften our goal is to reshape a data frame into a *tidy data* [@wickham2014] format. This is also known as **tall data or long data**. The {[tidyr](https://tidyr.tidyverse.org/)} package has functions to reshape data into tall or wide formats. When coding in the tidyverse context, tall data is much easier to iterate over --- without ever writing *for* loops or other kind of flow control. Later, in the [advance section, we'll introduce the {purrr} package](purrr.html \"purrr\") for more powerful iteration.\n\n[![Image credit: Tidy data from the book \\_R for Data Science\\_](images/tidy_data.png){fig-alt=\"Tidy data\"}](images/tidy_data.png)\n\nTidy data[^1]\n\n[^1]: A robust discussion of *tidy data* can be found in *R for Data Science* [@wickham2023]*: [https://r4ds.had.co.nz/tidy-data.html](https://r4ds.had.co.nz/tidy-data.htmlhttps://r4ds.had.co.nz/tidy-data.html)*\n\n-   Every variable is a column\n-   Every row is an observation\n-   Every cell is a single value\n\nMany of the [{dplyr} functions](https://dplyr.tidyverse.org/reference/index.html) help with making data tidy. **Additionally**, in this chapter, we focus on using the [{tidyr} function](https://tidyr.tidyverse.org/reference/index.html): `pivot_longer`, as well as `pivot_wider`.\n\nSee Also the [*Pivot Vignette*](https://tidyr.tidyverse.org/articles/pivot.html)\n\n## Load library packages\n\nLoad the {tidyverse} meta package which loads eight packges, including {tidyr}.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Data\n\nOur practice datasets are now available.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(relig_income)\ndata(fish_encounters)\n```\n:::\n\n\n## Longer\n\n> `pivot_longer()`\n\n::: column-margin\n\n```{=html}\n<iframe width=\"300\" height=\"200\" src=\"https://www.youtube.com/embed/sspFC2m8fog\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n```\n\n:::\n\nWe can start with the tidyr::relig_income data frame. This is wide data and does not conform to tidy data [@wickham2014] principles. This makes it harder to iterate by row because there are multiple observations in each row. In this data frame, each row has 10 observations, one observation for each income category.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrelig_income\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"religion\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"<$10k\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$10-20k\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$20-30k\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$30-40k\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$40-50k\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$50-75k\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$75-100k\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"$100-150k\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\">150k\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Don't know/refused\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Agnostic\",\"2\":\"27\",\"3\":\"34\",\"4\":\"60\",\"5\":\"81\",\"6\":\"76\",\"7\":\"137\",\"8\":\"122\",\"9\":\"109\",\"10\":\"84\",\"11\":\"96\"},{\"1\":\"Atheist\",\"2\":\"12\",\"3\":\"27\",\"4\":\"37\",\"5\":\"52\",\"6\":\"35\",\"7\":\"70\",\"8\":\"73\",\"9\":\"59\",\"10\":\"74\",\"11\":\"76\"},{\"1\":\"Buddhist\",\"2\":\"27\",\"3\":\"21\",\"4\":\"30\",\"5\":\"34\",\"6\":\"33\",\"7\":\"58\",\"8\":\"62\",\"9\":\"39\",\"10\":\"53\",\"11\":\"54\"},{\"1\":\"Catholic\",\"2\":\"418\",\"3\":\"617\",\"4\":\"732\",\"5\":\"670\",\"6\":\"638\",\"7\":\"1116\",\"8\":\"949\",\"9\":\"792\",\"10\":\"633\",\"11\":\"1489\"},{\"1\":\"Don’t know/refused\",\"2\":\"15\",\"3\":\"14\",\"4\":\"15\",\"5\":\"11\",\"6\":\"10\",\"7\":\"35\",\"8\":\"21\",\"9\":\"17\",\"10\":\"18\",\"11\":\"116\"},{\"1\":\"Evangelical Prot\",\"2\":\"575\",\"3\":\"869\",\"4\":\"1064\",\"5\":\"982\",\"6\":\"881\",\"7\":\"1486\",\"8\":\"949\",\"9\":\"723\",\"10\":\"414\",\"11\":\"1529\"},{\"1\":\"Hindu\",\"2\":\"1\",\"3\":\"9\",\"4\":\"7\",\"5\":\"9\",\"6\":\"11\",\"7\":\"34\",\"8\":\"47\",\"9\":\"48\",\"10\":\"54\",\"11\":\"37\"},{\"1\":\"Historically Black Prot\",\"2\":\"228\",\"3\":\"244\",\"4\":\"236\",\"5\":\"238\",\"6\":\"197\",\"7\":\"223\",\"8\":\"131\",\"9\":\"81\",\"10\":\"78\",\"11\":\"339\"},{\"1\":\"Jehovah's Witness\",\"2\":\"20\",\"3\":\"27\",\"4\":\"24\",\"5\":\"24\",\"6\":\"21\",\"7\":\"30\",\"8\":\"15\",\"9\":\"11\",\"10\":\"6\",\"11\":\"37\"},{\"1\":\"Jewish\",\"2\":\"19\",\"3\":\"19\",\"4\":\"25\",\"5\":\"25\",\"6\":\"30\",\"7\":\"95\",\"8\":\"69\",\"9\":\"87\",\"10\":\"151\",\"11\":\"162\"},{\"1\":\"Mainline Prot\",\"2\":\"289\",\"3\":\"495\",\"4\":\"619\",\"5\":\"655\",\"6\":\"651\",\"7\":\"1107\",\"8\":\"939\",\"9\":\"753\",\"10\":\"634\",\"11\":\"1328\"},{\"1\":\"Mormon\",\"2\":\"29\",\"3\":\"40\",\"4\":\"48\",\"5\":\"51\",\"6\":\"56\",\"7\":\"112\",\"8\":\"85\",\"9\":\"49\",\"10\":\"42\",\"11\":\"69\"},{\"1\":\"Muslim\",\"2\":\"6\",\"3\":\"7\",\"4\":\"9\",\"5\":\"10\",\"6\":\"9\",\"7\":\"23\",\"8\":\"16\",\"9\":\"8\",\"10\":\"6\",\"11\":\"22\"},{\"1\":\"Orthodox\",\"2\":\"13\",\"3\":\"17\",\"4\":\"23\",\"5\":\"32\",\"6\":\"32\",\"7\":\"47\",\"8\":\"38\",\"9\":\"42\",\"10\":\"46\",\"11\":\"73\"},{\"1\":\"Other Christian\",\"2\":\"9\",\"3\":\"7\",\"4\":\"11\",\"5\":\"13\",\"6\":\"13\",\"7\":\"14\",\"8\":\"18\",\"9\":\"14\",\"10\":\"12\",\"11\":\"18\"},{\"1\":\"Other Faiths\",\"2\":\"20\",\"3\":\"33\",\"4\":\"40\",\"5\":\"46\",\"6\":\"49\",\"7\":\"63\",\"8\":\"46\",\"9\":\"40\",\"10\":\"41\",\"11\":\"71\"},{\"1\":\"Other World Religions\",\"2\":\"5\",\"3\":\"2\",\"4\":\"3\",\"5\":\"4\",\"6\":\"2\",\"7\":\"7\",\"8\":\"3\",\"9\":\"4\",\"10\":\"4\",\"11\":\"8\"},{\"1\":\"Unaffiliated\",\"2\":\"217\",\"3\":\"299\",\"4\":\"374\",\"5\":\"365\",\"6\":\"341\",\"7\":\"528\",\"8\":\"407\",\"9\":\"321\",\"10\":\"258\",\"11\":\"597\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe can pivot this to tall data (i.e. `pivot_longer`) so that we have one observation per row for a total of 180 rows.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"religion\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"income\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"count\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Agnostic\",\"2\":\"<$10k\",\"3\":\"27\"},{\"1\":\"Agnostic\",\"2\":\"$10-20k\",\"3\":\"34\"},{\"1\":\"Agnostic\",\"2\":\"$20-30k\",\"3\":\"60\"},{\"1\":\"Agnostic\",\"2\":\"$30-40k\",\"3\":\"81\"},{\"1\":\"Agnostic\",\"2\":\"$40-50k\",\"3\":\"76\"},{\"1\":\"Agnostic\",\"2\":\"$50-75k\",\"3\":\"137\"},{\"1\":\"Agnostic\",\"2\":\"$75-100k\",\"3\":\"122\"},{\"1\":\"Agnostic\",\"2\":\"$100-150k\",\"3\":\"109\"},{\"1\":\"Agnostic\",\"2\":\">150k\",\"3\":\"84\"},{\"1\":\"Agnostic\",\"2\":\"Don't know/refused\",\"3\":\"96\"},{\"1\":\"Atheist\",\"2\":\"<$10k\",\"3\":\"12\"},{\"1\":\"Atheist\",\"2\":\"$10-20k\",\"3\":\"27\"},{\"1\":\"Atheist\",\"2\":\"$20-30k\",\"3\":\"37\"},{\"1\":\"Atheist\",\"2\":\"$30-40k\",\"3\":\"52\"},{\"1\":\"Atheist\",\"2\":\"$40-50k\",\"3\":\"35\"},{\"1\":\"Atheist\",\"2\":\"$50-75k\",\"3\":\"70\"},{\"1\":\"Atheist\",\"2\":\"$75-100k\",\"3\":\"73\"},{\"1\":\"Atheist\",\"2\":\"$100-150k\",\"3\":\"59\"},{\"1\":\"Atheist\",\"2\":\">150k\",\"3\":\"74\"},{\"1\":\"Atheist\",\"2\":\"Don't know/refused\",\"3\":\"76\"},{\"1\":\"Buddhist\",\"2\":\"<$10k\",\"3\":\"27\"},{\"1\":\"Buddhist\",\"2\":\"$10-20k\",\"3\":\"21\"},{\"1\":\"Buddhist\",\"2\":\"$20-30k\",\"3\":\"30\"},{\"1\":\"Buddhist\",\"2\":\"$30-40k\",\"3\":\"34\"},{\"1\":\"Buddhist\",\"2\":\"$40-50k\",\"3\":\"33\"},{\"1\":\"Buddhist\",\"2\":\"$50-75k\",\"3\":\"58\"},{\"1\":\"Buddhist\",\"2\":\"$75-100k\",\"3\":\"62\"},{\"1\":\"Buddhist\",\"2\":\"$100-150k\",\"3\":\"39\"},{\"1\":\"Buddhist\",\"2\":\">150k\",\"3\":\"53\"},{\"1\":\"Buddhist\",\"2\":\"Don't know/refused\",\"3\":\"54\"},{\"1\":\"Catholic\",\"2\":\"<$10k\",\"3\":\"418\"},{\"1\":\"Catholic\",\"2\":\"$10-20k\",\"3\":\"617\"},{\"1\":\"Catholic\",\"2\":\"$20-30k\",\"3\":\"732\"},{\"1\":\"Catholic\",\"2\":\"$30-40k\",\"3\":\"670\"},{\"1\":\"Catholic\",\"2\":\"$40-50k\",\"3\":\"638\"},{\"1\":\"Catholic\",\"2\":\"$50-75k\",\"3\":\"1116\"},{\"1\":\"Catholic\",\"2\":\"$75-100k\",\"3\":\"949\"},{\"1\":\"Catholic\",\"2\":\"$100-150k\",\"3\":\"792\"},{\"1\":\"Catholic\",\"2\":\">150k\",\"3\":\"633\"},{\"1\":\"Catholic\",\"2\":\"Don't know/refused\",\"3\":\"1489\"},{\"1\":\"Don’t know/refused\",\"2\":\"<$10k\",\"3\":\"15\"},{\"1\":\"Don’t know/refused\",\"2\":\"$10-20k\",\"3\":\"14\"},{\"1\":\"Don’t know/refused\",\"2\":\"$20-30k\",\"3\":\"15\"},{\"1\":\"Don’t know/refused\",\"2\":\"$30-40k\",\"3\":\"11\"},{\"1\":\"Don’t know/refused\",\"2\":\"$40-50k\",\"3\":\"10\"},{\"1\":\"Don’t know/refused\",\"2\":\"$50-75k\",\"3\":\"35\"},{\"1\":\"Don’t know/refused\",\"2\":\"$75-100k\",\"3\":\"21\"},{\"1\":\"Don’t know/refused\",\"2\":\"$100-150k\",\"3\":\"17\"},{\"1\":\"Don’t know/refused\",\"2\":\">150k\",\"3\":\"18\"},{\"1\":\"Don’t know/refused\",\"2\":\"Don't know/refused\",\"3\":\"116\"},{\"1\":\"Evangelical Prot\",\"2\":\"<$10k\",\"3\":\"575\"},{\"1\":\"Evangelical Prot\",\"2\":\"$10-20k\",\"3\":\"869\"},{\"1\":\"Evangelical Prot\",\"2\":\"$20-30k\",\"3\":\"1064\"},{\"1\":\"Evangelical Prot\",\"2\":\"$30-40k\",\"3\":\"982\"},{\"1\":\"Evangelical Prot\",\"2\":\"$40-50k\",\"3\":\"881\"},{\"1\":\"Evangelical Prot\",\"2\":\"$50-75k\",\"3\":\"1486\"},{\"1\":\"Evangelical Prot\",\"2\":\"$75-100k\",\"3\":\"949\"},{\"1\":\"Evangelical Prot\",\"2\":\"$100-150k\",\"3\":\"723\"},{\"1\":\"Evangelical Prot\",\"2\":\">150k\",\"3\":\"414\"},{\"1\":\"Evangelical Prot\",\"2\":\"Don't know/refused\",\"3\":\"1529\"},{\"1\":\"Hindu\",\"2\":\"<$10k\",\"3\":\"1\"},{\"1\":\"Hindu\",\"2\":\"$10-20k\",\"3\":\"9\"},{\"1\":\"Hindu\",\"2\":\"$20-30k\",\"3\":\"7\"},{\"1\":\"Hindu\",\"2\":\"$30-40k\",\"3\":\"9\"},{\"1\":\"Hindu\",\"2\":\"$40-50k\",\"3\":\"11\"},{\"1\":\"Hindu\",\"2\":\"$50-75k\",\"3\":\"34\"},{\"1\":\"Hindu\",\"2\":\"$75-100k\",\"3\":\"47\"},{\"1\":\"Hindu\",\"2\":\"$100-150k\",\"3\":\"48\"},{\"1\":\"Hindu\",\"2\":\">150k\",\"3\":\"54\"},{\"1\":\"Hindu\",\"2\":\"Don't know/refused\",\"3\":\"37\"},{\"1\":\"Historically Black Prot\",\"2\":\"<$10k\",\"3\":\"228\"},{\"1\":\"Historically Black Prot\",\"2\":\"$10-20k\",\"3\":\"244\"},{\"1\":\"Historically Black Prot\",\"2\":\"$20-30k\",\"3\":\"236\"},{\"1\":\"Historically Black Prot\",\"2\":\"$30-40k\",\"3\":\"238\"},{\"1\":\"Historically Black Prot\",\"2\":\"$40-50k\",\"3\":\"197\"},{\"1\":\"Historically Black Prot\",\"2\":\"$50-75k\",\"3\":\"223\"},{\"1\":\"Historically Black Prot\",\"2\":\"$75-100k\",\"3\":\"131\"},{\"1\":\"Historically Black Prot\",\"2\":\"$100-150k\",\"3\":\"81\"},{\"1\":\"Historically Black Prot\",\"2\":\">150k\",\"3\":\"78\"},{\"1\":\"Historically Black Prot\",\"2\":\"Don't know/refused\",\"3\":\"339\"},{\"1\":\"Jehovah's Witness\",\"2\":\"<$10k\",\"3\":\"20\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$10-20k\",\"3\":\"27\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$20-30k\",\"3\":\"24\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$30-40k\",\"3\":\"24\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$40-50k\",\"3\":\"21\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$50-75k\",\"3\":\"30\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$75-100k\",\"3\":\"15\"},{\"1\":\"Jehovah's Witness\",\"2\":\"$100-150k\",\"3\":\"11\"},{\"1\":\"Jehovah's Witness\",\"2\":\">150k\",\"3\":\"6\"},{\"1\":\"Jehovah's Witness\",\"2\":\"Don't know/refused\",\"3\":\"37\"},{\"1\":\"Jewish\",\"2\":\"<$10k\",\"3\":\"19\"},{\"1\":\"Jewish\",\"2\":\"$10-20k\",\"3\":\"19\"},{\"1\":\"Jewish\",\"2\":\"$20-30k\",\"3\":\"25\"},{\"1\":\"Jewish\",\"2\":\"$30-40k\",\"3\":\"25\"},{\"1\":\"Jewish\",\"2\":\"$40-50k\",\"3\":\"30\"},{\"1\":\"Jewish\",\"2\":\"$50-75k\",\"3\":\"95\"},{\"1\":\"Jewish\",\"2\":\"$75-100k\",\"3\":\"69\"},{\"1\":\"Jewish\",\"2\":\"$100-150k\",\"3\":\"87\"},{\"1\":\"Jewish\",\"2\":\">150k\",\"3\":\"151\"},{\"1\":\"Jewish\",\"2\":\"Don't know/refused\",\"3\":\"162\"},{\"1\":\"Mainline Prot\",\"2\":\"<$10k\",\"3\":\"289\"},{\"1\":\"Mainline Prot\",\"2\":\"$10-20k\",\"3\":\"495\"},{\"1\":\"Mainline Prot\",\"2\":\"$20-30k\",\"3\":\"619\"},{\"1\":\"Mainline Prot\",\"2\":\"$30-40k\",\"3\":\"655\"},{\"1\":\"Mainline Prot\",\"2\":\"$40-50k\",\"3\":\"651\"},{\"1\":\"Mainline Prot\",\"2\":\"$50-75k\",\"3\":\"1107\"},{\"1\":\"Mainline Prot\",\"2\":\"$75-100k\",\"3\":\"939\"},{\"1\":\"Mainline Prot\",\"2\":\"$100-150k\",\"3\":\"753\"},{\"1\":\"Mainline Prot\",\"2\":\">150k\",\"3\":\"634\"},{\"1\":\"Mainline Prot\",\"2\":\"Don't know/refused\",\"3\":\"1328\"},{\"1\":\"Mormon\",\"2\":\"<$10k\",\"3\":\"29\"},{\"1\":\"Mormon\",\"2\":\"$10-20k\",\"3\":\"40\"},{\"1\":\"Mormon\",\"2\":\"$20-30k\",\"3\":\"48\"},{\"1\":\"Mormon\",\"2\":\"$30-40k\",\"3\":\"51\"},{\"1\":\"Mormon\",\"2\":\"$40-50k\",\"3\":\"56\"},{\"1\":\"Mormon\",\"2\":\"$50-75k\",\"3\":\"112\"},{\"1\":\"Mormon\",\"2\":\"$75-100k\",\"3\":\"85\"},{\"1\":\"Mormon\",\"2\":\"$100-150k\",\"3\":\"49\"},{\"1\":\"Mormon\",\"2\":\">150k\",\"3\":\"42\"},{\"1\":\"Mormon\",\"2\":\"Don't know/refused\",\"3\":\"69\"},{\"1\":\"Muslim\",\"2\":\"<$10k\",\"3\":\"6\"},{\"1\":\"Muslim\",\"2\":\"$10-20k\",\"3\":\"7\"},{\"1\":\"Muslim\",\"2\":\"$20-30k\",\"3\":\"9\"},{\"1\":\"Muslim\",\"2\":\"$30-40k\",\"3\":\"10\"},{\"1\":\"Muslim\",\"2\":\"$40-50k\",\"3\":\"9\"},{\"1\":\"Muslim\",\"2\":\"$50-75k\",\"3\":\"23\"},{\"1\":\"Muslim\",\"2\":\"$75-100k\",\"3\":\"16\"},{\"1\":\"Muslim\",\"2\":\"$100-150k\",\"3\":\"8\"},{\"1\":\"Muslim\",\"2\":\">150k\",\"3\":\"6\"},{\"1\":\"Muslim\",\"2\":\"Don't know/refused\",\"3\":\"22\"},{\"1\":\"Orthodox\",\"2\":\"<$10k\",\"3\":\"13\"},{\"1\":\"Orthodox\",\"2\":\"$10-20k\",\"3\":\"17\"},{\"1\":\"Orthodox\",\"2\":\"$20-30k\",\"3\":\"23\"},{\"1\":\"Orthodox\",\"2\":\"$30-40k\",\"3\":\"32\"},{\"1\":\"Orthodox\",\"2\":\"$40-50k\",\"3\":\"32\"},{\"1\":\"Orthodox\",\"2\":\"$50-75k\",\"3\":\"47\"},{\"1\":\"Orthodox\",\"2\":\"$75-100k\",\"3\":\"38\"},{\"1\":\"Orthodox\",\"2\":\"$100-150k\",\"3\":\"42\"},{\"1\":\"Orthodox\",\"2\":\">150k\",\"3\":\"46\"},{\"1\":\"Orthodox\",\"2\":\"Don't know/refused\",\"3\":\"73\"},{\"1\":\"Other Christian\",\"2\":\"<$10k\",\"3\":\"9\"},{\"1\":\"Other Christian\",\"2\":\"$10-20k\",\"3\":\"7\"},{\"1\":\"Other Christian\",\"2\":\"$20-30k\",\"3\":\"11\"},{\"1\":\"Other Christian\",\"2\":\"$30-40k\",\"3\":\"13\"},{\"1\":\"Other Christian\",\"2\":\"$40-50k\",\"3\":\"13\"},{\"1\":\"Other Christian\",\"2\":\"$50-75k\",\"3\":\"14\"},{\"1\":\"Other Christian\",\"2\":\"$75-100k\",\"3\":\"18\"},{\"1\":\"Other Christian\",\"2\":\"$100-150k\",\"3\":\"14\"},{\"1\":\"Other Christian\",\"2\":\">150k\",\"3\":\"12\"},{\"1\":\"Other Christian\",\"2\":\"Don't know/refused\",\"3\":\"18\"},{\"1\":\"Other Faiths\",\"2\":\"<$10k\",\"3\":\"20\"},{\"1\":\"Other Faiths\",\"2\":\"$10-20k\",\"3\":\"33\"},{\"1\":\"Other Faiths\",\"2\":\"$20-30k\",\"3\":\"40\"},{\"1\":\"Other Faiths\",\"2\":\"$30-40k\",\"3\":\"46\"},{\"1\":\"Other Faiths\",\"2\":\"$40-50k\",\"3\":\"49\"},{\"1\":\"Other Faiths\",\"2\":\"$50-75k\",\"3\":\"63\"},{\"1\":\"Other Faiths\",\"2\":\"$75-100k\",\"3\":\"46\"},{\"1\":\"Other Faiths\",\"2\":\"$100-150k\",\"3\":\"40\"},{\"1\":\"Other Faiths\",\"2\":\">150k\",\"3\":\"41\"},{\"1\":\"Other Faiths\",\"2\":\"Don't know/refused\",\"3\":\"71\"},{\"1\":\"Other World Religions\",\"2\":\"<$10k\",\"3\":\"5\"},{\"1\":\"Other World Religions\",\"2\":\"$10-20k\",\"3\":\"2\"},{\"1\":\"Other World Religions\",\"2\":\"$20-30k\",\"3\":\"3\"},{\"1\":\"Other World Religions\",\"2\":\"$30-40k\",\"3\":\"4\"},{\"1\":\"Other World Religions\",\"2\":\"$40-50k\",\"3\":\"2\"},{\"1\":\"Other World Religions\",\"2\":\"$50-75k\",\"3\":\"7\"},{\"1\":\"Other World Religions\",\"2\":\"$75-100k\",\"3\":\"3\"},{\"1\":\"Other World Religions\",\"2\":\"$100-150k\",\"3\":\"4\"},{\"1\":\"Other World Religions\",\"2\":\">150k\",\"3\":\"4\"},{\"1\":\"Other World Religions\",\"2\":\"Don't know/refused\",\"3\":\"8\"},{\"1\":\"Unaffiliated\",\"2\":\"<$10k\",\"3\":\"217\"},{\"1\":\"Unaffiliated\",\"2\":\"$10-20k\",\"3\":\"299\"},{\"1\":\"Unaffiliated\",\"2\":\"$20-30k\",\"3\":\"374\"},{\"1\":\"Unaffiliated\",\"2\":\"$30-40k\",\"3\":\"365\"},{\"1\":\"Unaffiliated\",\"2\":\"$40-50k\",\"3\":\"341\"},{\"1\":\"Unaffiliated\",\"2\":\"$50-75k\",\"3\":\"528\"},{\"1\":\"Unaffiliated\",\"2\":\"$75-100k\",\"3\":\"407\"},{\"1\":\"Unaffiliated\",\"2\":\"$100-150k\",\"3\":\"321\"},{\"1\":\"Unaffiliated\",\"2\":\">150k\",\"3\":\"258\"},{\"1\":\"Unaffiliated\",\"2\":\"Don't know/refused\",\"3\":\"597\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Wider\n\nOf course, sometimes we want wide data. There are a variety of reasons to wrangle data into a wide-data format. We use `pivot_wider` to accomplish this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_encounters\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"fish\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"station\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"seen\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4842\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"MAE\",\"3\":\"1\"},{\"1\":\"4842\",\"2\":\"MAW\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"MAE\",\"3\":\"1\"},{\"1\":\"4843\",\"2\":\"MAW\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"MAE\",\"3\":\"1\"},{\"1\":\"4844\",\"2\":\"MAW\",\"3\":\"1\"},{\"1\":\"4845\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4845\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4845\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4845\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4845\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4847\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4847\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4847\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4848\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4848\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4848\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4848\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4849\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4849\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4850\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4851\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4851\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4854\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4854\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4855\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4855\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4855\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4855\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4855\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4857\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"MAE\",\"3\":\"1\"},{\"1\":\"4858\",\"2\":\"MAW\",\"3\":\"1\"},{\"1\":\"4859\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4859\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4859\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4859\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4859\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"MAE\",\"3\":\"1\"},{\"1\":\"4861\",\"2\":\"MAW\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"Lisbon\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"Rstr\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"Base_TD\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"BCE\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"BCW\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"BCE2\",\"3\":\"1\"},{\"1\":\"4862\",\"2\":\"BCW2\",\"3\":\"1\"},{\"1\":\"4863\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4863\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4864\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4864\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4865\",\"2\":\"Release\",\"3\":\"1\"},{\"1\":\"4865\",\"2\":\"I80_1\",\"3\":\"1\"},{\"1\":\"4865\",\"2\":\"Lisbon\",\"3\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfish_encounters %>% \n  pivot_wider(names_from = station, values_from = seen)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"fish\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Release\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"I80_1\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Lisbon\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Rstr\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Base_TD\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BCE\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BCW\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BCE2\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"BCW2\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"MAE\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"MAW\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4842\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\"},{\"1\":\"4843\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\"},{\"1\":\"4844\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\"},{\"1\":\"4845\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4847\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4848\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4849\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4850\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4851\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4854\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4855\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4857\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4858\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\"},{\"1\":\"4859\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4861\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"1\"},{\"1\":\"4862\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"1\",\"6\":\"1\",\"7\":\"1\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4863\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4864\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"},{\"1\":\"4865\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\",\"8\":\"NA\",\"9\":\"NA\",\"10\":\"NA\",\"11\":\"NA\",\"12\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Why pivot data?\n\nWhy pivot data? Your analysis may require the shape of data to match a particular structure. For example, ggplot generally prefers long tidy data. Once the data are properly shaped, analysis and variations becomes easier. Below is a quick example of using ggplot to format data in a long and tidy shape to create a bar plot. Of course, the plot needs some refining. Hence, improvements become easier to accomplish with the tall data shape. Nonetheless, below shows an initial draft of a bar plot.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\") %>% \n  ggplot(aes(religion, count, fill = income)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nOnce the data are properly shaped, variations on analysis becomes easier. Next, I format some variables as categorical vectors (i.e. factors), so that I can redraw the plot for clarity.\n\nMy goal is to format the vectors as factors using the `forcats` package. This will allow me to arrange\n\n-   the order of the bars\n-   the order of the stacked elements of each bar\n-   the order of the Legend\n\nI will also change the color scheme of the discrete color from the `fill` argument, in combination with the `scale_fill_viridis_d` function.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ninc_levels = c(\"Don't know/refused\",\n               \"<$10k\", \"$10-20k\", \"$20-30k\", \"$30-40k\",\n               \"$40-50k\", \"$50-75k\", \"$75-100k\", \"$100-150k\",\n               \">150k\")\n\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\") %>% \n  mutate(income = fct_relevel(income, inc_levels)) %>% \n  ggplot(aes(fct_reorder(religion, count), \n             count, fill = fct_rev(income))) +\n  geom_col() +\n  scale_fill_viridis_d(direction = -1) +\n  coord_flip() \n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nNonetheless, the un-pivoted, wide data, can be subset and visualized even though this is not ideal when attempting more complex visualization variations. Here, un-pivoted, I will make a bar chart of religious affiliation for incomes between \\$40k and \\$50k. Since I'm using just one variable, the code is not hard to compose. But note, the data re not in a tidy-data format.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrelig_income %>% \n  ggplot(aes(fct_reorder(religion, `$40-50k`), `$40-50k`)) +\n  geom_col() + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nTidy, `pivot_longer`, data will be easier to manipulate with `ggplot2`. For example, You can subset the data with a single `filter` function, thereby more easily enabling different income charts. Below, the code is easier to read and easier to modify if I want to use a different income value.\n\n> `filter(income == \"$40-50k\")`\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\") %>% \n  filter(income == \"$40-50k\") %>% \n  ggplot(aes(fct_reorder(religion, count), count)) +\n  geom_col() +\n  coord_flip() \n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nGetting more complex, a natural step is to make comparisons across incomes. To do this we use `ggplot2::facet_wrap()`\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\") %>% \n  mutate(income = fct_relevel(income, inc_levels)) %>% \n  ggplot(aes(fct_reorder(religion, count), \n             count)) +\n  geom_col(show.legend = FALSE) +\n  coord_flip() +\n  facet_wrap(vars(income), nrow = 2)\n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\nAnother variation. Again, ggplot2 affordances are easier to leverage with tall data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nrelig_income %>%\n  pivot_longer(-religion, names_to = \"income\", values_to = \"count\") %>% \n  mutate(religion = fct_lump_n(religion, 4, w = count)) %>% \n  mutate(income = fct_relevel(income, inc_levels)) %>% \n  group_by(religion, income) %>%\n  summarise(sumcount = sum(count)) %>% \n  ggplot(aes(fct_reorder(religion, sumcount), \n             sumcount)) + \n  geom_col(fill = \"grey80\", show.legend = FALSE) +\n  geom_col(data = . %>% filter(income == \"$40-50k\"),\n           fill = \"firebrick\") +\n  geom_col(data = . %>% filter(income == \">150k\"),\n           fill = \"forestgreen\") +\n  coord_flip() +\n  facet_wrap(vars(income), nrow = 2) \n```\n\n::: {.cell-output-display}\n![](longer_wider_files/figure-html/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "longer_wider_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}